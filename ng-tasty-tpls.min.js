angular.module("ngTasty",["ngTasty.tpls","ngTasty.table"]),angular.module("ngTasty.tpls",["template/table/tasty-head.html","template/table/tasty-pagination.html"]),angular.module("ngTasty.table",[]).directive("tastyTable",["$timeout",function(){return{restrict:"A",scope:!0,controller:function(a){this.$scope=a},link:function(a,n,e){"use strict";var t;if(!e.resource)throw"AngularJS tastyTable directive: miss the resource attribute";if(!a[e.resource])throw"AngularJS tastyTable directive: the resource ("+e.resource+") callback it's undefined";a.query={page:"page",count:"count",sortBy:"sort-by",sortOrder:"sort-order"},a.header={columns:[]},a.rows=[],a.params={},a.thead=!1,a.pagination=!1,a.resourcePagination={},a.url="",a.setDirectivesValues=function(n){return n?(a.rows=n.rows,a.header={columns:n.header,sortBy:n.sortBy,sortOrder:n.sortOrder},void(a.resourcePagination=n.pagination)):!1},a.setProperty=function(a,n,e){return n[e]&&(a[e]=n[e]),a},a.joinObjects=function(n,e){for(var t in e)a.setProperty(n,e,t);return n},a.buildUrl=function(n,t){var i,r;return i={},a.thead&&(i=a.setProperty(i,n,"sortBy"),i=a.setProperty(i,n,"sortOrder")),a.pagination&&(i=a.setProperty(i,n,"page"),i=a.setProperty(i,n,"count")),e.filters&&(i=a.joinObjects(i,t)),Object.keys(i).map(function(n){return r=i[n],a.query[n]&&(n=a.query[n]),encodeURIComponent(n)+"="+encodeURIComponent(r)}).join("&")},t=function(a,n){var e;return function(){var t=this,i=arguments;clearTimeout(e),e=setTimeout(function(){e=null,a.apply(t,i)},n)}},a.updateResource=t(function(){a.url=a.buildUrl(a.params,a[e.filters]),a[e.resource](a.url).then(function(n){a.setDirectivesValues(n)})},100),a.initDirective=function(){a.params.sortBy=void 0,a.params.sortOrder="asc",a.params.page=1,a.params.count=5,a.updateResource()},e.filters&&a.$watch(e.filters,function(n,e){n!==e&&a.updateResource()},!0),a.$watch("params",function(n,e){n!==e&&a.updateResource()},!0),a.initDirective()}}}]).directive("tastyThead",function(){return{restrict:"AE",require:"^tastyTable",scope:{},templateUrl:"template/table/tasty-head.html",link:function(a,n,e,t){"use strict";var i,r,s;t.$scope.thead=!0,t.$scope.params.thead=!0,a.fields={},s=!0,i=function(a){return a.replace(/[^a-zA-Z0-9-]+/g,"-").toLowerCase()},r=function(){var n,e;for(n=a.header.columns.length,e=0;n>e;e++)a.fields[a.header.columns[e].key]={width:100/n,sort:i(a.header.columns[e].key)};"dsc"===a.header.sortOrder&&(a.header.sortBy="-"+a.header.sortBy)},a.sortBy=function(n){var e;e=i(n.key),a.header.sortBy==e?(a.header.sortBy="-"+e,t.$scope.params.sortOrder="dsc"):(a.header.sortBy=e,t.$scope.params.sortOrder="asc"),t.$scope.params.sortBy=n.key},a.isSortUp=function(n){return void 0===a.fields[n.key]?!1:a.header.sortBy=="-"+a.fields[n.key].sort},a.isSortDown=function(n){return void 0===a.fields[n.key]?!1:a.header.sortBy==a.fields[n.key].sort},t.$scope.$watch("header",function(n,e){n&&n!==e&&(a.header=t.$scope.header,r())})}}}).directive("tastyPagination",function(){return{restrict:"AE",require:"^tastyTable",scope:{},templateUrl:"template/table/tasty-pagination.html",link:function(a,n,e,t){"use strict";var i,r,s,o,p,g,c,u;t.$scope.pagination=!0,t.$scope.params.pagination=!0,a.numPaginations=5,a.pagListCount=[5,25,50,100],a.pagination={},a.pagMinRange=1,a.pagMaxRange=1,c=!0,u=function(a,n){var e;e=[],a=parseInt(a,10),n=parseInt(n,10);for(var t=a;n>t;t++)e.push(t);return e},i=function(a){t.$scope.params.page=a},r=function(n){var e;e=n*a.pagination.page,e>a.pagination.size&&(t.$scope.params.page=Math.ceil(a.pagination.size/n)),t.$scope.params.count=n},s=function(){var n;n=a.pagination.page,n>a.pagination.pages&&(n=a.pagination.pages),a.pagMinRange=n-2>0?n-2:1,a.pagMaxRange=n+2,a.pagination.page=n,g()},o=function(){return a.pagHideMinRange===!0||a.pagMinRange<1?!1:(a.pagMaxRange=a.pagMinRange,a.pagMinRange=a.pagMaxRange-a.numPaginations,void g())},p=function(){return a.pagHideMaxRange===!0||a.pagMaxRange>a.pagination.pages?!1:(a.pagMinRange=a.pagMaxRange,a.pagMaxRange=a.pagMinRange+a.numPaginations,a.pagMaxRange>a.pagination.pages&&(a.pagMaxRange=a.pagination.pages),a.pagMinRange=a.pagMaxRange-a.numPaginations,void g())},g=function(){a.pagMinRange=a.pagMinRange>0?a.pagMinRange:1,a.pagMaxRange=a.pagMinRange+a.numPaginations,a.pagMaxRange>a.pagination.pages&&(a.pagMaxRange=a.pagination.pages+1),a.pagHideMinRange=a.pagMinRange<=1,a.pagHideMaxRange=a.pagMaxRange>=a.pagination.pages,a.pagListCount=a.pagination.size<50?[5,25]:a.pagination.size<100?[5,25,50]:[5,25,50,100],a.rangePage=u(a.pagMinRange,a.pagMaxRange)},a.page={get:i,setCount:r,previous:o,remaining:p},t.$scope.$watch("resourcePagination",function(n,e){n&&n!==e&&(a.pagination={count:n.count,page:n.page,pages:n.pages,size:n.size},s())})}}}),angular.module("template/table/tasty-head.html",[]).run(["$templateCache",function(a){a.put("template/table/tasty-head.html",'<tr>\n  <th ng-repeat="column in header.columns" \n  ng-class="{active: column.key == header.sortBy}"\n  ng-click="sortBy(column)">\n    <span ng-bind="column.name"></span>\n    <span ng-if="isSortUp(column)" class="fa fa-sort-up"></span>\n    <span ng-if="isSortDown(column)" class="fa fa-sort-down"></span>\n  </th> \n</tr>')}]),angular.module("template/table/tasty-pagination.html",[]).run(["$templateCache",function(a){a.put("template/table/tasty-pagination.html",'<div class="row">\n  <div class="col-md-3 text-left">\n    <div class="btn-group">\n      <button type="button" class="btn btn-default" \n      ng-repeat="count in pagListCount" \n      ng-class="{active: count == pagination.count}" \n      ng-click="page.setCount(count)" ng-bind="count"></button>\n    </div>\n  </div>\n  <div class="col-md-6 text-center">\n    <ul class="pagination">\n      <li ng-class="{disabled: pagHideMinRange }">\n        <span ng-click="page.previous()">&laquo;</span>\n      </li>\n      <li ng-repeat="numPage in rangePage" ng-class="{active: numPage == pagination.page}">\n        <span ng-click="page.get(numPage)">\n          <span ng-bind="numPage"></span>\n          <span class="sr-only" ng-if="numPage == pagination.page">(current)</span>\n        </span>\n      </li>\n      <li ng-class="{disabled: pagHideMaxRange }">\n        <span ng-click="page.remaining()">&raquo;</span>\n      </li>\n    </ul>\n  </div>\n  <div class="col-md-3 text-right">\n    <p>Page <span ng-bind="pagination.page"></span> \n    of <span ng-bind="pagination.pages"></span>,\n    of <span ng-bind="pagination.size"></span> entries</p>\n  </div>\n</div>')}]);